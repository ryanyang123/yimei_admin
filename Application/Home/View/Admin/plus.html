<!--引用文件head-->
<include file="common/header"/>


<!-- 上传图片 -->

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/bootstrap-fileupload.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/jquery.gritter.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/chosen.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/select2_metro.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/jquery.tagsinput.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/clockface.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/bootstrap-wysihtml5.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/datepicker.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/timepicker.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/colorpicker.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/bootstrap-toggle-buttons.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/daterangepicker.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/datetimepicker.css" />

<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/multi-select-metro.css" />

<link href="__PUBLIC__/css/bootstrap-modal.css" rel="stylesheet" type="text/css"/>

<!-- 上传图片-->

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

<!-- BEGIN HEADER -->

<!--头部导航栏-->
<include file="common/top"/>



<div class="page-container">


    <!--导航栏-->
    <include file="common/nav"/>



    <div class="page-content">


        <!-- BEGIN PAGE CONTAINER-->

        <div class="container-fluid">

            <!-- BEGIN PAGE HEADER-->

            <div class="row-fluid">

                <div class="span12">



                    <!--颜色选择-->
                    <include file="common/color"/>



                    <!-- BEGIN PAGE TITLE & BREADCRUMB-->

                    <h3 class="page-title">

                        {$title} <small>操作</small>

                    </h3>

                    <ul class="breadcrumb">

                        <li>

                            <i class="icon-home"></i>

                            <a href="<?php echo U('home/home/index');?>">主页</a>

                            <i class="icon-angle-right"></i>

                        </li>

                        <li>

                            <i class="icon-long-arrow-right"></i>

                            <a href="<?php echo U('home/'.$at.'/index');?>">账号管理</a>

                            <i class="icon-angle-right"></i>

                        </li>

                        <li><a href="#"><?php echo $is_edit?'修改'.$title:'新增'.$title;?></a></li>



                    </ul>

                    <!-- END PAGE TITLE & BREADCRUMB-->

                </div>

            </div>

            <!-- END PAGE HEADER-->

            <div id="dashboard">



                <div class="row-fluid">

                    <div class="span12">

                        <!-- BEGIN PORTLET-->

                        <div class="portlet box">



                            <div class="portlet-body form">

                                <!-- BEGIN FORM-->



                                <form action="<?php echo U('home/GameAdd/upload_thumb');?>" class="form-horizontal">




                                    <input type="text" style="width: 0;height: 0;padding: 0;border: none;"  name="test2"  value="" >
                                    <input type="password" style="width: 0;height: 0;padding: 0;border: none;" name="test3"  value="">




                            <div class="control-group">


                                <label class="control-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登陆账号</font></font></label>

                                        <div class="controls">
                                            <input type="text" placeholder="请输入登陆账号" autocomplete="off"  name="admin_id"  value="{$list.admin_id}" class="m-wrap medium">
                                        </div>

                                    </div>

                                    <div class="control-group">

                                        <label class="control-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">账号名称</font></font></label>

                                        <div class="controls">

                                            <input type="text" placeholder="请输入账号名称（备注）" autocomplete="off" name="admin_name"  value="{$list.admin_name}" class="m-wrap medium">


                                        </div>

                                    </div>


                                    <div class="control-group">

                                        <label class="control-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登陆密码</font></font></label>

                                        <div class="controls">

                                            <input type="password" placeholder="请输入账号密码" name="password" autocomplete="off"  value="" class="m-wrap medium">


                                        </div>

                                    </div>

                                    <div class="control-group">
                                        <label class="control-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确认密码</font></font></label>
                                        <div class="controls">
                                            <input type="password" placeholder="请输入确认密码" name="password2" autocomplete="off"  value="" class="m-wrap medium">
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="control-group">
                                        <label class="control-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限备注</font></font></label>
                                        <div class="controls">
                                            <input type="text" placeholder="权限备注" name="limits_name"  value="{$list.limits_name}" class="m-wrap medium">
                                        </div>
                                    </div>

                                    <div class="control-group">

                                        <label class="control-label">权限分配</label>

                                        <div class="controls">
                                            <foreach name="limits_list" item="v">
                                                <label class="checkbox limits_{$v.db_name}" ">
                                                    <span><input class="limits" type="checkbox" <if condition="$v.is_on eq 1">checked</if>  name="limits" value="{$v.db_name}"></span> {$v.name}
                                                </label>
                                                <br>
                                            </foreach>


                                        </div>
                                    </div>



                                    <div class="form-actions">

                                        <button type="button" id="js_btn" onclick="SubmitData()" class="btn blue"><i class="icon-ok"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 保存</font></font></button>

                                        <button type="button" onclick="to_gen()" class="btn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取消</font></font></button>



                                    </div>

                                </form>

                                <!-- END FORM-->

                            </div>

                        </div>

                        <!-- END PORTLET-->

                    </div>

                </div>


                <div class="clearfix"></div>





            </div>

        </div>

        <!-- END PAGE CONTAINER-->

    </div>

    <!-- END PAGE -->

</div>

<!-- END CONTAINER -->
<include file="common/footer"/>
<include file="common/tz"/>
<!-- END JAVASCRIPTS -->

</body>


<!-- END BODY -->

</html>
<script src="__PUBLIC__/js/ajaxfileupload.js"></script>
<script>

    function admintype(){
        var type_id = $('#type_id').val();
        if(type_id=='2'){
            $('.limits_1').show();
            $('.limits_2').hide();
        }else{
            $('.limits_1').hide();
            $('.limits_2').show();
        }
    }

    var is_Edit = '<?php echo $is_edit;?>';
    var parent_url = "<?php echo U('home/'.$at.'/index');?>";

    function to_gen(){
        window.location.href = parent_url;
    }

    function SubmitData(){
        var arrlist=new Array();
        var tmp="";
        $("input[name='limits']:checkbox:checked").each(function(){
            arrlist.push($(this).val());
        });
        tmp = arrlist.join(",");
        var admin_id = $.trim($("*[name='admin_id']").val());
        var admin_name = $.trim($("*[name='admin_name']").val());
        var password = $.trim($("*[name='password']").val());
        var password2 = $.trim($("*[name='password2']").val());
        var limits_name = $.trim($("*[name='limits_name']").val());

        if(!admin_id){showAlert("请输入登陆账号");return false;}
        if(!admin_name){showAlert("请输入账号名称");return false;}
        if(!is_Edit){
            if(!password){showAlert("请输入登陆密码");return false;}
        }

        if(password != password2){showAlert("两次密码输入不一致");return false;}

        $('#js_btn').attr('disabled',true);
        $.ajax({
            type: 'POST',
            dataType: "json",
            url: "<?php echo U('home/'.$at.'/add'); ?>",
            data:{admin_id:admin_id,admin_name:admin_name,password:password,limits:tmp,limits_name:limits_name,is_edit:is_Edit},
            success: function (result) {
                if(result.code == 1){
                    showAlert(result.res);
                    window.location.href= parent_url;
                }else if(result.code==0){
                    showAlert(result.res);
                    $('#js_btn').attr('disabled',false);
                }else{
                    showAlert("提交失败，请检查您的输入是否合法");
                    $('#js_btn').attr('disabled',false);
                }
            }
        });

    }

</script>