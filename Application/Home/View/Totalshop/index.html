<!--引用文件head-->
<include file="common/header"/>

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

<!-- BEGIN HEADER -->

<!--头部导航栏-->
<include file="common/top"/>



<div class="page-container">


    <!--导航栏-->
    <include file="common/nav"/>



    <div class="page-content">
        <!-- BEGIN PAGE CONTAINER-->
        <div class="container-fluid">
            <!-- BEGIN PAGE HEADER-->
            <div class="row-fluid">
                <div class="span12">

                    <!--颜色选择-->
                    <include file="common/color"/>



                    <!-- BEGIN PAGE TITLE & BREADCRUMB-->

                    <h3 class="page-title">

                        商家 <small>统计</small>

                    </h3>

                    <ul class="breadcrumb">
                        <li>
                            <i class="icon-home"></i>

                            <a href="<?php echo U('home/home/index');?>">主页</a>

                            <i class="icon-angle-right"></i>
                        </li>

                        <li><a href="#">商家统计</a></li>
                    </ul>

                    <!-- END PAGE TITLE & BREADCRUMB-->

                </div>

            </div>

            <!-- END PAGE HEADER-->

            <div id="dashboard">

                <style>
                    .ninyueri{
                        margin: 0;
                        padding: 0;
                        list-style: none;
                    }
                    .ninyueri li{
                        float: left;
                        width: 33.3%;
                    }
                    .ninyueri li a{
                        display: block;
                        width: 100%;
                        text-align: center;
                        text-decoration: none;
                        color: #333;;
                        height: 40px;
                        line-height: 40px;;
                        border: 1px solid #ccc;;
                    }
                    .ninyueri li a.nyr_active{

                        background: #e02222;
                        color: #fff;
                    }
                </style>

                <div class="row-fluid">

                    <div style="height: 50px;">
                        <ul class="ninyueri">
                            <li><a href="{:U('home/totalshop/index/ytype/1')}" <if condition="$search_list['ytype'] eq 1"> class="nyr_active" </if> >年</a></li>
                            <li><a href="{:U('home/totalshop/index/ytype/2')}" <if condition="$search_list['ytype'] eq 2"> class="nyr_active" </if>>月</a></li>
                            <li><a href="{:U('home/totalshop/index/ytype/3')}" <if condition="$search_list['ytype'] eq 3"> class="nyr_active" </if>>日</a></li>
                        </ul>
                    </div>
                    <div class="row-fluid search-forms search-default">

                        <form class="form-search" method="get" action="{:U('home/'.$at.'/index')}">

                            <div class="chat-form clearfix">

                                <div class="input-cont" style="width:100%;float: left;margin-right: 20px;margin-bottom: 2px;min-width: 210px;">

                                    <if condition="$search_list['ytype'] eq 2 or $search_list['ytype'] eq 1">
                                    <select name="year" id="" style="line-height: 34px;height: 34px;">
                                        <foreach name="year_list" item="v">
                                            <option <if condition="$search_list['year'] eq $v"> selected </if> value="{$v}" >{$v}年</option>
                                        </foreach>
                                    </select>
                                    </if>
                                    <if condition="$search_list['ytype'] eq 2">
                                    <select name="month" id="" style="line-height: 34px;height: 34px;">
                                        <for start="1" end="13" name="i">
                                            <option <if condition="$search_list['month'] eq $i"> selected </if> value="{$i}" >{$i}月</option>
                                        </for>
                                    </select>
                                    </if>

                                    <if condition="$search_list['ytype'] eq 3">
                                        <input type="text" placeholder="开始时间 " value="{$search_list['search_date']}" name="search_date" class="m-wrap large auto-kal">
                                    </if>

                                    <if condition="$search_list['ytype'] eq 4">
                                        <input type="text" placeholder="开始时间 " value="{$search_list['search_date2']}" name="search_date2" class="m-wrap large auto-kal">
                                    </if>

                                    <button type="submit" class="btn green" style="right: inherit;margin-left: 10px;">查 询 &nbsp; <i class="m-icon-swapright m-icon-white"></i></button>
                                    <input type="hidden" name="ytype" value="{$search_list.ytype}"/>
                                </div>
                            </div>

                        </form>

                    </div>

                    <div id="main" style="height:400px"></div>
                    <div id="main2" style="height:400px"></div>



                </div>


                <div class="clearfix"></div>
                <hr/>
                <div class="portlet-body" style="overflow: auto;">

                    <span style="color: #333;font-size: 15px;font-weight: bolder;">搜索总商家数：<span style="color: red;">{$zong_list.zong_user}</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <span style="color: #333;font-size: 15px;font-weight: bolder;">搜索总商家在线人数：<span style="color: red;">{$zong_list.zong_online}</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <span style="color: #333;font-size: 15px;font-weight: bolder;">搜索总销售数：<span style="color: red;">{$zong_list.zong_sales}</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <span style="color: #333;font-size: 15px;font-weight: bolder;">搜索总销售金额：<span style="color: red;">{$zong_list.zong_money}</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


                    <!--<div class="btn-group" style="float: right;">


                        <a href="{:U('home/inout/expLiRunLog/ytype/'.$search_list['ytype'].'/year/'.$search_list['year'].'/month/'.$search_list['month'].'/search_date/'.$search_list['search_date'].'/search_date2/'.$search_list['search_date2'])}" id="sample_editable_1_new" class="btn green" >

                             导出Excel <i class="icon-signin"></i>

                        </a>

                    </div>-->


                    <table class="table table-striped table-hover" style="min-width: 860px;">

                        <thead>

                        <tr>
                            <th>序号</th>
                            <th>查询时间</th>
                            <th>商家数量</th>
                            <th>在线人数</th>
                            <th>销售数量</th>
                            <th>销售金额</th>


                        </tr>

                        </thead>

                        <tbody>
                        <if condition="$excel_list">
                            <foreach name="excel_list" item="v" key="key">
                                <tr>
                                    <td>
                                        {$key+1}
                                    </td>
                                    <td>
                                        {$v.title}
                                    </td>
                                    <td>
                                        {$v.user}
                                    </td>
                                    <td>
                                        {$v.online}
                                    </td>
                                    <td>
                                        {$v.sales}
                                    </td>
                                    <td>
                                        {$v.money}
                                    </td>


                                </tr>
                            </foreach>
                            <else />
                            <tr>
                                <td colspan="10"><p class="no_data">暂时没有数据</p></td>
                            </tr>
                        </if>



                        </tbody>

                    </table>

                </div>





            </div>

        </div>

        <!-- END PAGE CONTAINER-->

    </div>

    <!-- END PAGE -->

</div>



<include file="common/footer"/>
<include file="common/tz"/>
<!-- END JAVASCRIPTS -->

</body>
<!-- END BODY -->

</html>
<script src="__PUBLIC__/echarts-2.2.7/build/dist/echarts.js"></script>
<script>

    // 路径配置
    require.config({
        paths: {
            echarts: '__PUBLIC__/echarts-2.2.7/build/dist/'
        }
    });

    // 使用
    require(
            [
                'echarts',
                'echarts/chart/line', // 使用柱状图就加载bar模块，按需加载
                'echarts/chart/bar' // 使用柱状图就加载bar模块，按需加载
            ],
            function (ec) {
                // 基于准备好的dom，初始化echarts图表
                var myChart = ec.init(document.getElementById('main'));
                var myChart2 = ec.init(document.getElementById('main2'));

                var month_arr = $.parseJSON('{$month_arr}');
                var user_arr = $.parseJSON('{$user_arr}');
                var online_arr = $.parseJSON('{$online_arr}');
                var sales_arr = $.parseJSON('{$sales_arr}');
                var money_arr = $.parseJSON('{$money_arr}');

                var option = {
                    title : {
                        text: '商家数据',
                        subtext: '在线人数|店铺数量|销售数量 统计'
                    },
                    tooltip : {
                        trigger: 'axis'
                    },
                    legend: {
                        data:['店铺数量','在线人数','销售数量']
                    },
                    toolbox: {
                        show : true,
                        feature : {
                            mark : {show: false},
                            dataView : {show: true, readOnly: false},
                            magicType : {show: true, type: ['line', 'bar']},
                            restore : {show: true},
                            saveAsImage : {show: true}
                        }
                    },
                    calculable : true,
                    xAxis : [
                        {
                            type : 'category',
                            boundaryGap : false,
                            data : month_arr
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value',
                            axisLabel : {
                                formatter: '{value} 数量'
                            }
                        }
                    ],
                    series : [
                        {
                            name:'店铺数量',
                            type:'line',
                            data:user_arr,
                            markPoint : {
                                data : [
                                    {type : 'max', name: '最大值'},
                                    {type : 'min', name: '最小值'}
                                ]
                            },
                            markLine : {
                                data : [
                                    {type : 'average', name: '平均值'}
                                ]
                            }
                        },
                        {
                            name:'在线人数',
                            type:'line',
                            data:online_arr,
                            markPoint : {
                                data : [
                                    {type : 'max', name: '最大值'},
                                    {type : 'min', name: '最小值'}
                                ]
                            },
                            markLine : {
                                data : [
                                    {type : 'average', name : '平均值'}
                                ]
                            }
                        },
                        {
                            name:'销售数量',
                            type:'line',
                            data:sales_arr,
                            markPoint : {
                                data : [
                                    {type : 'max', name: '最大值'},
                                    {type : 'min', name: '最小值'}
                                ]
                            },
                            markLine : {
                                data : [
                                    {type : 'average', name : '平均值'}
                                ]
                            }
                        }
                    ]
                };

                var option2 = {
                    title : {
                        text: '商家数据',
                        subtext: '销售金额 统计'
                    },
                    tooltip : {
                        trigger: 'axis'
                    },
                    legend: {
                        data:['销售金额']
                    },
                    toolbox: {
                        show : true,
                        feature : {
                            mark : {show: false},
                            dataView : {show: true, readOnly: false},
                            magicType : {show: true, type: ['line', 'bar']},
                            restore : {show: true},
                            saveAsImage : {show: true}
                        }
                    },
                    calculable : true,
                    xAxis : [
                        {
                            type : 'category',
                            boundaryGap : false,
                            data : month_arr
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value',
                            axisLabel : {
                                formatter: '{value} 员'
                            }
                        }
                    ],
                    series : [
                        {
                            name:'销售金额',
                            type:'line',
                            data:money_arr,
                            markPoint : {
                                data : [
                                    {type : 'max', name: '最大值'},
                                    {type : 'min', name: '最小值'}
                                ]
                            },
                            markLine : {
                                data : [
                                    {type : 'average', name: '平均值'}
                                ]
                            }
                        }
                    ]
                };

                // 为echarts对象加载数据
                myChart.setOption(option);
                myChart2.setOption(option2);
            }
    );

</script>